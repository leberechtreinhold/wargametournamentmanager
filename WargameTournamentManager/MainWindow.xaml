<Controls:MetroWindow x:Class="WargameTournamentManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:simpleChildWindow="clr-namespace:MahApps.Metro.SimpleChildWindow;assembly=MahApps.Metro.SimpleChildWindow"
        xmlns:local="clr-namespace:WargameTournamentManager"
        mc:Ignorable="d"
        xmlns:Controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
        Title="Gestor de Torneos para Wargames" Height="450" Width="800">

    <Controls:MetroWindow.Resources>
        <local:TournamentActiveConverter x:Key="TournamentActiveConverter"/>
    </Controls:MetroWindow.Resources>

    <Grid>
        <TabControl x:Name="MainTab">
            <TabItem Header="Torneo" IsEnabled="{Binding currentTournament, Converter={StaticResource TournamentActiveConverter}}">
                <Grid DataContext="creationTournament">
                    <simpleChildWindow:ChildWindow 
                        x:Name="createTournamentWindow"
                        Title="Crear Torneo"
                        Padding="20"
                        ShowCloseButton="True"
                        DataContext="{Binding creationTournament}">

                        <simpleChildWindow:ChildWindow.OverlayBrush>
                            <SolidColorBrush Opacity="0" Color="{StaticResource Gray2}" />
                        </simpleChildWindow:ChildWindow.OverlayBrush>

                        <Grid Margin="20">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Label Grid.Row="0" Grid.Column="0" Margin="5" 
                                   Content="Nombre"/>
                            <TextBox Grid.Row="0" Grid.Column="1" Margin="5" 
                                     Text="{Binding Name}" Width="200" 
                                     Controls:TextBoxHelper.Watermark="Nombre del torneo" />
                            <Label Grid.Row="1" Grid.Column="0" Margin="5" 
                                   Content="Juego"/>
                            <TextBox Grid.Row="1" Grid.Column="1" Margin="5" 
                                     Text="{Binding Game}" Width="200" 
                                     Controls:TextBoxHelper.Watermark="Nombre del juego" />
                            <Label Grid.Row="2" Grid.Column="0" Margin="5" 
                                   Content="Número de rondas"/>
                            <Controls:NumericUpDown Grid.Row="2" Grid.Column="1"  
                                                    Minimum="0" Maximum="10" 
                                                    Width="200" Margin="5" 
                                                    Value="{Binding Config.NumberRounds}" />
                            <Label Grid.Row="3" Grid.Column="0" Margin="5" 
                                   Content="Puntos por victoria"/>
                            <Controls:NumericUpDown Grid.Row="3" Grid.Column="1"
                                                    Minimum="0" Maximum="20000"
                                                    Width="200" Margin="5" 
                                                    Value="{Binding Config.PointsPerWin}" />
                            <Label Grid.Row="4" Grid.Column="0" Margin="5" 
                                   Content="Puntos por empate"/>
                            <Controls:NumericUpDown Grid.Row="4" Grid.Column="1" 
                                                    Minimum="0" Maximum="20000"
                                                    Width="200" Margin="5" 
                                                    Value="{Binding Config.PointsPerDraw}" />
                            <Label Grid.Row="5" Grid.Column="0" Margin="5" 
                                   Content="Puntos por derrota"/>
                            <Controls:NumericUpDown Grid.Row="5" Grid.Column="1" 
                                                    Minimum="0" Maximum="20000"
                                                    Width="200" Margin="5" 
                                                    Value="{Binding Config.PointsPerLoss}" />
                            <Button Grid.Row="6" Grid.Column="1" Margin="20" 
                                    Content="Save" Click="SaveTournament_Click">
                                
                            </Button>
                        </Grid>
                    </simpleChildWindow:ChildWindow>
                    <StackPanel Margin="20"  HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Button x:Name="LoadTournamentButton"
                                Content="Cargar fichero de Torneo" 
                                Margin="20" 
                                Controls:ButtonHelper.PreserveTextCase="True" 
                                Style="{StaticResource AccentedSquareButtonStyle}" 
                                Click="LoadTournament_Click"/>
                        <Button x:Name="CreateNewTournamentButton"
                                Content="Crear nuevo Torneo" 
                                Margin="20" 
                                Controls:ButtonHelper.PreserveTextCase="True" 
                                Style="{StaticResource AccentedSquareButtonStyle}" 
                                Click="CreateNewTournament_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            <TabItem Header="Jugadores" 
                     IsEnabled="{Binding currentTournament, Converter={StaticResource TournamentActiveConverter}}">
                <StackPanel Margin="20" DataContext="{Binding currentTournament}">
                    <StackPanel Orientation="Horizontal" >
                        <Label Content="Name"/>
                        <TextBox Text="{Binding Name}" IsEnabled="False" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <Label Content="Fecha"/>
                        <TextBox Text="{Binding Date}" IsEnabled="False" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <Label Content="Juego"/>
                        <TextBox Text="{Binding Game}" IsEnabled="False" />
                    </StackPanel>
                    <StackPanel>
                        <DataGrid ItemsSource="{Binding Players}" Margin="10,20,10,0" AutoGenerateColumns="False" CanUserAddRows="false" Style="{StaticResource AzureDataGrid}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Binding="{Binding Name}" Header="Nombre" />
                                <DataGridTextColumn Binding="{Binding City}" Header="Ciudad" />
                                <DataGridTextColumn Binding="{Binding Club}" Header="Club" />
                                <DataGridTextColumn Binding="{Binding Contact}" Header="Contacto" />
                                <DataGridTextColumn Binding="{Binding Faction}" Header="Facción" />
                                <DataGridCheckBoxColumn Binding="{Binding Paid}" Header="Inscripción pagada" />
                            </DataGrid.Columns>
                        </DataGrid>
                        <StackPanel Orientation="Horizontal">
                            <Button Content="Borrar seleccionados" Margin="20" Controls:ButtonHelper.PreserveTextCase="True" Style="{StaticResource AccentedSquareButtonStyle}" />
                            <Button Content="Añadir nuevo jugador" Margin="20" Controls:ButtonHelper.PreserveTextCase="True" Style="{StaticResource AccentedSquareButtonStyle}" />
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </TabItem>
            <TabItem Header="Enfrentamientos"
                     IsEnabled="{Binding currentTournament, Converter={StaticResource TournamentActiveConverter}}">
                <local:MatchupsScreen />
            </TabItem>
            <TabItem Header="Ranking" 
                     IsEnabled="{Binding currentTournament, Converter={StaticResource TournamentActiveConverter}}">
                <StackPanel Margin="20" DataContext="{Binding currentTournament}">
                    <StackPanel Orientation="Horizontal" >
                        <Label Content="Name"/>
                        <TextBox Text="{Binding Name}" IsEnabled="False" />
                    </StackPanel>
                    <StackPanel>
                        <DataGrid ItemsSource="{Binding Ranking}"
                                  Margin="10,20,10,0" 
                                  AutoGenerateColumns="True" 
                                  CanUserAddRows="false" 
                                  Style="{StaticResource AzureDataGrid}">
                        </DataGrid>
                    </StackPanel>
                </StackPanel>
            </TabItem>
        </TabControl>
    </Grid>
</Controls:MetroWindow>
